# 需求文档

## 简介

本文档定义了 Aibrary 平台的用户邀请好友注册送积分系统需求。该系统允许现有用户通过邀请链接或邀请码邀请新用户注册，当被邀请用户成功注册并满足条件时，邀请人和被邀请人都可以获得积分奖励。系统旨在通过用户推荐机制增加用户获取，提高用户活跃度和留存率。

## 需求

### 需求 1：邀请链接和邀请码生成

**用户故事：** 作为一个注册用户，我想要生成专属的邀请链接和邀请码，以便分享给朋友邀请他们注册

#### 验收标准

1. 当用户进入邀请页面时，系统应当自动为其生成唯一的邀请码（6-8位字母数字组合）
2. 当用户请求邀请链接时，系统应当生成包含邀请码的专属链接
3. 当用户复制邀请链接时，系统应当提供一键复制功能
4. 当用户查看邀请统计时，系统应当显示已邀请人数、成功注册人数和获得积分总数
5. 如果用户的邀请码已存在，则系统应当返回现有的邀请码而不是重新生成
6. 当用户分享邀请信息时，系统应当提供预设的分享文案模板

### 需求 2：被邀请用户注册流程

**用户故事：** 作为一个被邀请的新用户，我想要通过邀请链接或邀请码注册，以便我和邀请人都能获得奖励

#### 验收标准

1. 当用户通过邀请链接访问注册页面时，系统应当自动填充邀请码
2. 当用户在注册页面手动输入邀请码时，系统应当验证邀请码的有效性
3. 当用户完成注册时，系统应当记录邀请关系
4. 当被邀请用户成功注册时，系统应当在用户资料中标记其为被邀请用户
5. 如果邀请码无效或已过期，则系统应当提示用户但仍允许正常注册
6. 当被邀请用户注册成功时，系统应当向邀请人发送通知

### 需求 3：积分奖励发放

**用户故事：** 作为邀请人，我想要在被邀请的朋友成功注册后获得积分奖励，以便激励我邀请更多朋友

#### 验收标准

1. 当被邀请用户成功注册时，系统应当立即为邀请人发放 200 积分
2. 当被邀请用户成功注册时，系统应当立即为被邀请人发放 100 积分
3. 当积分发放时，系统应当记录详细的积分获得记录，包括来源和关联的用户信息
4. 当积分发放成功时，系统应当向用户发送积分到账通知
5. 如果同一设备或IP地址多次注册，则系统应当仅为第一次有效注册发放奖励
6. 当系统检测到异常注册行为时，系统应当暂停积分发放并标记进行人工审核

### 需求 4：邀请关系管理

**用户故事：** 作为一个用户，我想要查看我的邀请记录和被邀请记录，以便了解我的邀请成果和来源

#### 验收标准

1. 当用户查看邀请统计时，系统应当显示成功邀请的用户数量
2. 当用户查看邀请明细时，系统应当显示被邀请用户的注册时间（不显示个人信息）
3. 当用户查看积分明细时，系统应当区分显示邀请奖励获得的积分
4. 当被邀请用户查看个人信息时，系统应当显示邀请人的用户名（如邀请人允许显示）
5. 如果用户要求删除邀请关系记录，则系统应当支持但保留积分发放记录
6. 当管理员查看用户关系时，系统应当提供完整的邀请关系链查询功能

### 需求 5：防刷机制

**用户故事：** 作为系统管理员，我想要防止用户通过恶意手段刷取积分奖励，以便保护平台利益

#### 验收标准

1. 当系统检测到同一IP地址短时间内多次注册时，应当标记为可疑行为
2. 当系统检测到同一设备标识多次注册时，应当仅认定第一次注册为有效
3. 当用户尝试邀请自己时，系统应当阻止此操作
4. 当系统发现异常注册模式时（如批量注册、虚假信息等），应当暂停相关账号的积分奖励
5. 如果邀请人在一段时间内邀请成功数量异常（如一天内超过 50 人），则系统应当触发人工审核
6. 当发现刷积分行为时，系统应当支持批量回收相关积分并封禁相关账号

### 需求 6：积分奖励配置管理

**用户故事：** 作为系统管理员，我想要灵活配置邀请奖励规则，以便适应不同的运营策略

#### 验收标准

1. 当管理员修改邀请人奖励积分时，系统应当应用于后续的邀请奖励发放
2. 当管理员修改被邀请人奖励积分时，系统应当应用于后续的注册奖励发放
3. 当管理员设置邀请码有效期时，系统应当在邀请码过期后拒绝使用
4. 当管理员启用/禁用邀请功能时，系统应当立即生效
5. 如果管理员设置每日邀请上限，则系统应当在达到上限后暂停当日邀请功能
6. 当管理员查看邀请统计时，系统应当提供详细的数据报表和异常行为报告

### 需求 7：通知和提醒

**用户故事：** 作为用户，我想要及时收到邀请相关的通知，以便了解邀请进展和积分变化

#### 验收标准

1. 当有用户通过我的邀请注册时，系统应当立即向我发送通知
2. 当我通过邀请注册获得积分时，系统应当发送积分到账通知
3. 当我邀请的用户成功注册时，系统应当显示邀请成功的庆祝消息
4. 当积分发放时，系统应当在积分记录中明确标注来源为邀请奖励
5. 如果系统开展邀请活动，则应当通过消息推送或邮件通知用户
6. 当用户查看通知历史时，系统应当支持按邀请相关内容筛选

### 需求 8：数据统计和分析

**用户故事：** 作为产品运营人员，我想要查看详细的邀请数据统计，以便分析邀请功能效果和优化策略

#### 验收标准

1. 当查看总体统计时，系统应当显示总邀请人数、成功注册数和转化率
2. 当查看时间维度统计时，系统应当支持按日、周、月查看邀请趋势
3. 当查看用户维度统计时，系统应当显示邀请最多的用户排行榜
4. 当查看积分发放统计时，系统应当显示因邀请功能发放的积分总量
5. 如果需要导出数据，则系统应当支持导出邀请关系和统计数据
6. 当生成报表时，系统应当包含异常行为检测和风险提示信息